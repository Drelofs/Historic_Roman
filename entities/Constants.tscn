[gd_scene load_steps=5 format=2]

[ext_resource path="res://entities/Actors/Player.tscn" type="PackedScene" id=1]
[ext_resource path="res://Interface/Pausescreen.tscn" type="PackedScene" id=2]

[sub_resource type="GDScript" id=3]
script/source = "extends Node


# Declare member variables here. Examples:
# var a: int = 2
# var b: String = \"text\"


# Called when the node enters the scene tree for the first time.
func _ready() -> void:
	pass # Replace with function body.


# Called every frame. 'delta' is the elapsed time since the previous frame.
#func _process(delta: float) -> void:
#	pass
"

[sub_resource type="GDScript" id=2]
script/source = "extends KinematicBody2D

var speed := 0
var max_speed := 400
var acceleration := 800
var moving := false

var target = Vector2()
var velocity = Vector2()

var path := PoolVector2Array() setget set_path 

func _ready() -> void:
	set_process(false)

func _process(delta: float) -> void:
	var move_distance : = speed * delta
	move_along_path(move_distance)	

func move_along_path(distance : float) -> void:
	var start_point : = position
	for i in range(path.size()):
		var distance_to_next : = start_point.distance_to(path[0])
		if distance <= distance_to_next and distance >= 0.0:
			position = start_point.linear_interpolate(path[0], distance / distance_to_next)
			break
		elif distance < 0.0:
			position = path[0]
			set_process(false)
			break
		distance -= distance_to_next
		start_point = path[0]
		path.remove(0)

func set_path(value: PoolVector2Array):
	path = value
	if value.size() == 0:
		return
	set_process(true)	

func _unhandled_input(event):
	if event.is_action_pressed(\"left_click\"):
		moving = true
		target = get_global_mouse_position()
	
func _physics_process(delta):
	MovementLoop(delta)	
	
func MovementLoop(delta):
	if moving == false:
		speed = 0
	else: 
		speed += acceleration * delta
		if speed > max_speed:
			speed = max_speed	
	velocity = position.direction_to(target) * speed
	if position.distance_to(target) > 5:
		velocity = move_and_slide(velocity)
	else: 
		moving = false	
"

[node name="Constants" type="Node"]
script = SubResource( 3 )

[node name="Player" parent="." instance=ExtResource( 1 )]
position = Vector2( 1581.28, 951.23 )
z_index = 10
script = SubResource( 2 )

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="Pausescreen" parent="CanvasLayer" instance=ExtResource( 2 )]
visible = false
